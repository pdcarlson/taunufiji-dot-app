name: Scheduled Cron Job

on:
    schedule:
        # Runs every 12 minutes (production only)
        - cron: "*/12 * * * *"
    workflow_dispatch:
        inputs:
            environment:
                description: "Target environment"
                required: true
                default: "production"
                type: choice
                options:
                    - production
                    - staging

jobs:
    cron:
        runs-on: ubuntu-latest
        timeout-minutes: 5
        environment: ${{ github.event.inputs.environment || 'production' }}

        steps:
            - name: Trigger cron endpoint
              run: |
                  echo "ðŸŽ¯ Environment: ${{ github.event.inputs.environment || 'production' }}"
                  curl -f -X GET \
                    "${{ secrets.NEXT_PUBLIC_APP_URL }}/api/cron?key=${{ secrets.CRON_SECRET }}&job=HOURLY"
